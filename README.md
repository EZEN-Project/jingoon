# jingoon
진군 저장소

210322

- 회원가입 임계테스트, 회원수정 임계테스트, 포인트 충전 임계테스트, 장바구니 입력수정 , 테스트 기록 및 정리
- carousel의 중복 제거
- 헤더에 회원가입 버튼 추가
- 장바구니 상품 입력버튼 중복 수정
- 장바구니 담기 코드 수정 :  장바구니의 개수 비교 코드의 오류

CartVO oriCartVO=cartDAO.getCart(cartNo);
amount = amount + oriCartVO.getAmount();


![image](https://user-images.githubusercontent.com/72857217/111974760-22ed9f80-8b43-11eb-9657-577dbb75c56c.png)



---


210319

로그인 요청시, 로그인 후 로그인 전 페이지로 되돌아옴
carousel과 상품게시물 페이지의 사진을 연결하하여 메인페이지 수정
이전페이지가 널이거나 로그인페이지인 경우 메인페이지로 이동
point입력값 테스트 및 수정 중
0-성공,1-성공,-1-성공,문자-실패,특수문자-실패,공백-실패


---


210318

- 모달창 input태그 엔터키 확인
1. 폼태그의 삭제
> 폼태그에 하나의 인풋태그가 있을 때 엔터는 폼테그의 submit을 작동
2. 인풋태그 추가
> 두개 이상의 인풋태그가 있으면 엔터로 submit작동을 하지 않는다
3. 이벤트를 지정
> 인풋태그를 선택자로 엔터키가 눌렸을 때 발생할 이벤트를 작성

- 모달창 인풋태그의 엔터로 넘어가기 막기
> 모달창이 자동으로 hide되야 하는데 엔터키를 이벤트로 지정함으로 모달창이 닫히지 않는다
 
- 상품게시물의 이미지가 없을 때 장바구니에 담을 이미지 패스를 처리
- 결제창의 엔터입력 막기
- 회원탈퇴 후 구매내역 출력 문제
- Test기록 정리 중
- 깃허브 연결
- 결제내역 모두삭제
- 상품목록의 이미지 추가


---


210317

> ajax 통신을 사용한 장바구니의 기능에 로그인권한을 확인하는 방법
장바구니에 상품을 담는 기능을 ajax로 하고 있어서 로그인 후 장바구니로 이동됨
	
- 장바구니 목록 개수 표시(뱃지)를 로그인했을 때만 가져오기
- 회원타입변경과 회원포인트변경은 회원수정과 분리 : 회원 정보수정과 기능을 구분
- 로그아웃 상태에서 장바구니에 상품을 담으면 로그인화면으로 이동
장바구니에 상품을 담는 기능을 ajax로 하고 있어서 로그인 후 장바구니로 이동됨.. 해결 고민
- 장바구니의 상태변화 시 장바구니 뱃지 갱신
- 결제확인 창에서 비밀번호가 틀렸을 때 다시 결제확인창을 띄우면 이전 작성한 비밀번호가 남아있음 수정

> 포인트의 갱신 
- x login정보에서 point를 가져와서 출력
- 결제를 했을 때 로그인 첫 결제는 정상적으로 보이지만 두번째 부터는 첫 결제 후의 포인트가 갱신되지 않음
- 포인트 충전 후 결제페이지의 포인트 갱신안됨
- x 포인트가 변경되면 변경된 포인트를 세션에 저장으로 결제 시 포인트 출력
- 세션에 계속 값을 변경하는거나 세션에 로그인된 회원정보를 갱신하는거나 차이가 없음
- x 포인트 변경을 쿠키에 저장
- 쿠키의 사용을 금지하는 클라이언트의 경우가 문제가됨.
>> 해결방법: 결제 이벤트가 시작할 때 포인트를 가져오는 ajax추가, 중첩 ajax로 비동기화 문제해결

- 포인트 충전 : 숫자가 아닐때 리턴
- 포인트 변경(충전/결제) 구현 완료

- 장바구니의 이미지 클릭시 상품등록 게시글 보기
- 회원가입, 조회/수정/탈퇴, 로그인, 포인트갱신, 로그인 권한(장바구니,회원가입,수정) 적용 

- 장바구니 2차완성, 회원가입, 로그인 구현, 장바구니 회원권한추가 
- 마이페이지, 관리자페이지 기능과 병합 후 충돌 수정

![화면 캡처 2021-03-17 175541](https://user-images.githubusercontent.com/72857217/111441866-159f7200-874b-11eb-8dd0-d77479c7cb7b.png)
![화면 캡처 2021-03-17 175633](https://user-images.githubusercontent.com/72857217/111441869-16d09f00-874b-11eb-94c7-074a241137e7.png)
![화면 캡처 2021-03-17 180030](https://user-images.githubusercontent.com/72857217/111441872-17693580-874b-11eb-83f3-f385fdbd3f48.png)



210316


게시글 작성/수정/삭제 로그인 권한 적용
게시글 로그인회원과 글쓴 회원이 같을 때만 수정/삭제 버튼 보이기
게시글 리스트/조회/수정, 회원조회/수정 view에 로그인 헤더 추가
로그인 후 loginPost.jsp를 찾을 수 없다는 오류
->  postHandle에서 respons.sendRedirect() 이후의 코드도 실행됨
-> loginPost.jsp(빈페이지)추가 
회원 조회/수정/삭제 적용
-> 회원삭제의 경우 타입변경으로 수정
탈퇴회원 로그인 불가


---


210312

상품 게시물 기능을 맡은 도현님과 소스를 합치고 서로의 기능을 적용하기 위한 수정 및 테스트
- sellboard/read
- 장바구니 버튼 추가
- 구매개수 입력창, 구매개수가 판매개수보다 크면 안내창
- 상품을 장바구니에 추가하고 장바구니 배지의 숫자 카운팅 갱신

- 장바구니 입력 : insert 수정, 상품수량 비교
- 장바구니 목록 : getList 수정, img 가져오기 썸네일 변경(164x164),

장바구니번호로 조회 추가
- 상품수량, 상품가격, 결제가격의 각 기능을 카트 조회로 통합
- Service를 남겨두고 DAO, mapper의 조회를 통합 
- 상품 수량뒤에 판매수량 출력 
- 장바구니 비우기 버튼: 장바구니에 상품 추가되면 생성. 장바구니의 모든 상품 삭제



---


210311
- 결제내역에 이미지 추가, VO만들기

 1.회원정보 가져오기 - 비밀번호 일치 확인, 불일치 시 리턴
 2.회원정보 에서 포인트 확인
 3.장바구니에서 정보 가져오기 - 총 가격 확인
 4.포인트와 결제가격 비교, 포인트가 모자라면 리턴 
 5.상품 판매수량이 구매개수보다 부족하면 리턴
 6.상품 판매수량 업데이트
 7.판매정보 입력(저장)
 8.장바구니 삭제
 9.회원 포인트 업데이트
 10. 6,7,8,9 트렌젝션 적용
* 결제 완료 후 마이페이지의 결제내역 창으로 이동
* 포인트 부족 리턴 확인, 수량부족 리턴확인, 판매정보 입력실패/장바구니삭제 트렌젝션 확인

- view에서 장바구니에 상품이 없으면 결제창이 안나오게
- view에서 상품수량이 구매수량보다 부족하면 결제창이 안나오게 
- 상품 수량 변경(+,-) 후 결제버튼을 눌렀을 때 DB에는 변경돼지만 view의 저장정보는 변경돼지 않아서 수량비교에 오류
-> 결제버튼을 누르면 변경된 수량을 갱신시켜줘야 한다. 
-> 결제 시 DB에 저장된 최신 정보와 사용자의 입력값을 비교
- 상품 제한 수량까지 +버튼이 유효
- 결제 창에 진입후 DB에 수량,가격 등 상품정보가 변동된 경우/ 서비스단에서 최종 확인 후 트렌젝션



---

210310

진군
- 장바구니 부트스트렙 css 적용
- 부트스트렙으로 변경된 태그들의 이벤트 script수정
- 결제 페이지 구상 :  결제를 누르면 결제확인창(모달창)으로 내 포인트와 결제금액 잔액을 출력, 확인을 누르면 결제가 이루어지고 판매 정보(sell 테이블,VO)를 저장 + 포인트를 수정 ( 트렌젝션 ) + 장바구니 삭제 (트렌젝션) 
- 결제 확인 페이지 구성 : 결제확인 창에서 비밀번호를 입력받아 ajax통신, 비밀번호를 입력하지 않으면 안내창 띄우고 모달창 닫기
- 장바구니 결제 구현 중

![화면 캡처 2021-03-10 123658](https://user-images.githubusercontent.com/72857217/110608461-9ef4f880-81cf-11eb-829d-6bf62ba66869.png)
![Inked화면 캡처 2021-03-10 123658_LI](https://user-images.githubusercontent.com/72857217/110608470-a1575280-81cf-11eb-94c4-2d8d4d4dc449.jpg)
![화면 캡처 2021-03-10 165209](https://user-images.githubusercontent.com/72857217/110608481-a3211600-81cf-11eb-864e-6a47dc02ea9e.png)



---


210309 진행상황
- 장바구니 상품 추가 조건 추가 : 상품의 제한(판매수량)을 비교해서 추가 수량이나 입력수량이 판매수량보다 많거나 같을 때 입력제한, 
- 장바구니 상품 감소 조건 추가 : 장바구니 상품의 개수가 1개 일때 더이상 감소할 수 없고, 삭제 경고창을 띄우고 - 버튼을 숨김
- 장바구니 구성변경 : 상품의 개수만 가지고 상품의 가격은 상품테이블에서 받아서 사용했지만, 장바구니에서 상품개수를 수시로 수정함으로 상품의 가격을 저장, 개수와 가격의 곱으로 구매가격을 저장
- 컨트롤러에서 작업하던 입력, 수정, 조건문에 따른 로직을 서비스단으로 이동
- 뷰 : 스크립트에서 상품의 정보와 장바구니의 정보를 취합하여 뷰로 출력

결제테이블 구성
- 주키와, 판매자, 구매상품, 구매상품개수, 구매상품가격(개수*가격), 그룹넘버(장바구니에서 동시결제), 결제시간 으로 구성

장바구니 상품추가 수정( 상품결제가격추가, 제한수량 확인 )
- 입력한 상품의 개수와 상품의 가격으로 aPrice를 구해서 저장. 
- 입력한 상품의 개수가, 상품정보의 제한수량보다 작거나 같을 때 장바구니 추가
- 이미 장바구니에 존재하는 상품이면 장바구니의 상품의 개수+입력상품 개수가 상품의 제한 수량보다 적거나 같을 때 추가

![화면 캡처 2021-03-08 175755](https://user-images.githubusercontent.com/72857217/110608647-c8ae1f80-81cf-11eb-802f-fd36468dc143.png)
![화면 캡처 2021-03-09 105133](https://user-images.githubusercontent.com/72857217/110608652-c9df4c80-81cf-11eb-8069-0f5dbfe5b2ec.png)


---


- <진군 2021.03.08>
- 상품을 장바구니에 등록 :  이미 장바구니에 담긴 상품은 개수가 증가하고, 처음 담는 상품은 장바구니에 추가
- 장바구니의 상품 삭제 :  장바구니 삭제 후 장바구니에 상품태그를 삭제하고, 장바구니 총 가격을 갱신
- 장바구니 상품 개수 증감 : 장바구니 상품의 구매개수를 변경, 상품의 총가격과 장바구니 총 가격을 수정&갱신
- 장바구니의 총 상품 가격 표시
- 장바구니의 목록을 버튼 배지로 표현

![화면 캡처 2021-03-07 210431](https://user-images.githubusercontent.com/72857217/110608653-ca77e300-81cf-11eb-87c5-51e8227af554.png)
![화면 캡처 2021-03-08 104459](https://user-images.githubusercontent.com/72857217/110608656-ca77e300-81cf-11eb-9de8-3725026f522e.png)
